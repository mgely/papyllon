# measurement script
qubit_list = np.linspace(6010000000.0,6040000000.0,801)
pna = qt.instruments.create('pna','PNA_N5221A_sal',address = 'TCPIP::192.168.1.42::INSTR')
curr_source = qt.instruments.create('curr_source','keysight_source_B2961A',address = 'TCPIP::192.168.1.56::INSTR')
var_att = qt.instruments.create('var_att','agilent_var_attenuator',address = 'TCPIP::192.168.1.113::INSTR')
pna.reset()
pna.setup_two_tone(4200000000.0,4300000000.0,801,1,50,15,6010000000.0,6040000000.0,801,5,1,3,4601000000.0,6268900000.0,15)
curr_source.set_output_type('CURR')
curr_source.set_voltage_protection(0.1)
curr_source.set_protection_state(True)
curr_source.set_state(True)
var_att.set_var_att(70)
qt.mstart()
data = qt.Data(name='data')
data.create_file(datadirs=r'D:\steelelab-nas\measurement_data\BlueFors\door_computer\Sal\Kurma6A_C\2015_12_15_______10.20.59_____TwoTone__qubit_linewidth')
spyview_process_3D(reset=True)
data.add_coordinate('Frequency [Hz]')
data.add_coordinate('I_coil [A]')
data.add_coordinate('no Z coordinate')
data.add_value('linmag')
data.add_value('phase')
data.add_value('f_cav [Hz]')
curr_source.ramp_source_curr(0.00015)
pna.reset_averaging()
pna.reset_two_tone_cavity()
pna.w('DISP:WIND1:TRAC1:Y:SCAL:AUTO')
pna.trigger(channel = 2)
pna.w('CALC2:FORM PHASE')
pna.w('DISP:WIND2:TRAC1:Y:SCAL:AUTO')
pna.trigger(channel = 2)